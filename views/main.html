<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Event Driven</title>

    <style>
        :root {
            font-size: 14px;
        }
    </style>
</head>
<body>
<div id="container">
    <div id="title">
        <h1>Draw event driven flow  </h1>
    </div>
    <div id="main">
        <div id="head">
            <label for="addEvent">이벤트 추가</label>
            <input id="addEvent" autofocus type="text" placeholder="이벤트 추가">
        </div>

        <svg id="draw-space" width="100%" height="100%"
             style="touch-action: none; background-color: rgb(255, 255, 255); display: block; user-select: none; background-image: radial-gradient(rgba(73, 80, 87, 0.7) 1px, transparent 0px); background-size: 24px 24px; background-position: 48.8047px 78.8359px;">
            <polyline points="220,50  240,50" style="fill:none;stroke:red;stroke-width:4"></polyline>
        </svg>

    </div>
</div>
</body>
<script src="../js/linkedList.js"></script>

<script>

    const link = new LinkedList();


    const inputBox = document.getElementById('addEvent');
    inputBox.addEventListener('keypress', (e) => {
        const inputText = e.target.value;
        if (e.key === 'Enter' && inputText !== '') {
            const inputText = e.target.value;
            addList(inputText);
            inputBox.value = '';
        }
    });
</script>

<script>
    function addList(text) {
        const lastLink = [...link.printListData()][0]
        const obj = lastLink
            ? {x: 30 + lastLink?.x + lastLink?.width, y: 20, width: 100, height: 70, text}
            : {x: 30, y: 20, width: 100, height: 70, text};
        //

        const textSpite = text => {
            let result = ''
            text.match(/(.{1,8})/g).forEach(e => {
                console.log("e?", e)
                result += `<tspan>${e}</tspan>`;
            })
            return result;
        }

        const box = `<g id="start">
                         <rect x="${obj.x}" y="${obj.y}" width="${obj.width}" height="${obj.height}" rx="10" fill="skyblue"/>
                         <text x="${obj.x + (obj.width / 2)}" y="${obj.y + (obj.height / 2)}" text-anchor="middle" dominant-baseline="middle"  font-size="1rem" fill="black">
                         ${textSpite(text)}
                         </text>
                     </g>`;

        link.insertFirst(obj);
        const test = document.getElementById('draw-space');
        test.innerHTML = test.innerHTML.concat(box)

    }


</script>
</html>